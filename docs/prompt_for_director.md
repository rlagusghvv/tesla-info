# Prompt for Director (이사님 작업용)

목표: TeslaSubDash iPad 앱(TestFlight)에서 **Car Mode / Navi / Media / Fleet Control**을 안정적으로 완성한다.
대상 디바이스: **iPad mini 6** (세로/가로 모두 고려, 특히 Safe Area 상단)
현재 빌드: 25 기준으로 아래 이슈들이 미해결.

## 1) UI 레이아웃/가시성 (최우선)
- 문제: 상단 UI(바/패널/배너)가 **상단 status bar/safe area에 너무 붙어있고**, 여러 패널이 **겹쳐서** 가시성/터치가 나쁨. 일부는 상단 시스템 바가 눌림.
- 요구사항:
  1) Car Mode 전체 UI를 **safe area 기준 아래로 내리기**(top padding/offset, geometry 기반)
  2) 겹치는 패널 정리: 네비 길안내 패널, Kakao API 패널, UI 토글 패널 간 간격 확보
  3) 가능하면 **네비 모드 내 배너/패널을 드래그로 위치 이동** 가능하게(사용자가 원하는 위치로 옮길 수 있도록)
  4) HUD/오버레이는 “터치할 때만 나타남(auto-hide)”을 기본으로 하되, 너무 빨리 사라지지 않게(타이머 여유)

## 2) Media 오버레이 리사이즈 버그
- 문제: Media 탭에서 “사이즈 키우기/줄이기”를 누르면 컨테이너 크기가 바뀌는 게 아니라 **웹페이지 자체가 줌(확대/축소)** 되는 듯 동작.
- 요구사항:
  1) 확대/축소는 **WKWebView viewport zoom**이 아니라 **오버레이 컨테이너 frame**이 커지/작아지도록 수정
  2) 리사이즈 UX: **프리셋(예: S/M/L/Full)** + **모서리 드래그 자유 리사이즈**
  3) 리사이즈 조작이 어렵다는 피드백 있음 → 핸들/버튼 등 명확한 affordance 제공
  4) “미디어에서 보던 웹페이지를 그대로 줄이기”는 현재 구조상 어렵다면(새 WKWebView 인스턴스 문제) 이유를 명확히 하고, 가능한 범위에서 세션/URL 유지 또는 snapshot 유지 등 대안 제시

## 3) Navi(카카오 지도) 내비게이션 품질 개선
- 문제: 길안내 시작해도 지도가 줌인되지 않고(세계지도처럼 멀리), 주행/이동에 따라 지도가 자연스럽게 따라오지 않음.
- 요구사항:
  1) 길안내 시작 시 **자동 줌인**(route bounds fit + 적절한 zoom level)
  2) 주행 중 차량 위치 갱신 시 **카메라 follow** (heading/position smoothing)
  3) next maneuver 거리(예: 191m) 기반으로 줌/카메라를 동적으로 조절(가까워지면 더 줌인)
  4) UI 패널들이 지도와 겹치지 않게(1번 UI 개선과 연동)
  5) 검색 품질: 예) “강남역” 검색 시 관련도 낮은 결과가 상위에 뜸 → 카카오 검색 파라미터/정렬/필터 개선 필요

## 4) Fleet control(락/언락 등) 안정화
- 문제: Lock/Unlock 등 버튼 누르면 앱에 **"Server error (received HTML)"** 같은 오류가 뜨며 작동 안 함. FleetStatus 테스트 시 앱이 멈추는 이슈도 있음.
- 요구사항:
  1) command API가 실패하더라도 앱이 멈추지 않게(타임아웃/취소/에러 핸들링)
  2) 서버 응답은 항상 JSON으로(HTML 응답을 UI가 받지 않도록) → 백엔드/터널 경로에서 HTML 섞임 원인 제거
  3) TeslaMate는 기본적으로 ‘조작’ 기능이 제한적일 수 있으니,
     - **Hybrid 전략**: TeslaMate=위치/상태 폴링, Fleet API=command(락/언락/클라이밋/웨이크)로 fallback
  4) 퇴근길(18:00) 실사용 목표 → 최소한 lock/unlock/wake/climate 4개는 안정적으로 동작해야 함

## 산출물(이사님 작업 결과물)
- PR/커밋으로 위 4개 영역 중 우선순위대로 개선 반영
- iPad mini 6 기준 스크린샷/짧은 체크리스트 포함
- 크래시/프리즈 재현 조건과 해결 방식 문서화(간단히)

## 제한/운영 룰
- 텔레그램 논의 금지(대표 태그 호출 제외). 진행/결과는 MD로만.
- 민감정보(키/토큰/.p8 등)는 채팅/MD/레포에 원문 절대 금지.
